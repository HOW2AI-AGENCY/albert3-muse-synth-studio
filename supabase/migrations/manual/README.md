# Ручные миграции Supabase

Некоторые изменения схемы или данных сложно выразить через стандартные auto-generated миграции Supabase CLI. В таких случаях мы ведём каталог ручных сценариев.

## Как использовать каталог `manual`

1. Создайте новый SQL-файл с префиксом порядкового номера и кратким описанием, например `0002_backfill_profiles.sql`.
2. Внутри файла опишите:
   - цель миграции и причину, почему она выполняется вручную;
   - точные SQL-команды, которые необходимо выполнить;
   - инструкции по проверке результатов и отката при необходимости.
3. Обновите этот README, если появляются новые классы ручных операций (например, backfill, hotfix, миграции из внешних систем).
4. При выполнении ручной миграции убедитесь, что она задокументирована в PR и зафиксирована в Supabase Studio/консоле.

## Шаблон

Для ускорения работы используйте файл [`0001_template.sql`](./0001_template.sql). Он содержит заготовку с разделами для описания контекста, SQL-команд, шагов проверки и отката.

## Review-процесс

- Любой PR с изменениями в каталоге `manual` должен содержать план запуска и ожидания от QA.
- Перед выполнением ручной миграции её необходимо согласовать минимум с одним backend-инженером и владельцем продукта.
- После применения миграции обновите этот каталог: отметьте дату выполнения и ответственного.
