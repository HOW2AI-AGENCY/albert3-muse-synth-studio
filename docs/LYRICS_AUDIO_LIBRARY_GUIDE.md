# Lyrics & Audio Library - User Guide

## üìö –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–∏—Ä–∏–∫–æ–π –∏ –∞—É–¥–∏–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å –∏ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤—ã–≤–∞—Ç—å —Ç–µ–∫—Å—Ç—ã –ø–µ—Å–µ–Ω
- –£–ø—Ä–∞–≤–ª—è—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π –∞—É–¥–∏–æ-—Ñ–∞–π–ª–æ–≤
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

---

## üéµ –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ª–∏—Ä–∏–∫–∏

### –î–æ—Å—Ç—É–ø
–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Workspace ‚Üí –õ–∏—Ä–∏–∫–∞** (`/workspace/lyrics-library`)

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### 1. –ü—Ä–æ—Å–º–æ—Ç—Ä –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
- **–í—Å–µ** - –ø–æ–∫–∞–∑–∞—Ç—å –≤—Å—é –ª–∏—Ä–∏–∫—É
- **–ò–∑–±—Ä–∞–Ω–Ω–æ–µ** ‚≠ê - —Ç–æ–ª—å–∫–æ –∏–∑–±—Ä–∞–Ω–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã
- **–ü–∞–ø–∫–∏** üìÅ - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –ø–∞–ø–∫–∞–º

#### 2. –ü–æ–∏—Å–∫
```
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç—Ä–æ–∫—É –ø–æ–∏—Å–∫–∞ –¥–ª—è:
- –ü–æ–∏—Å–∫ –ø–æ —Ç–µ–∫—Å—Ç—É –ø–µ—Å–Ω–∏
- –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é
- –ü–æ–∏—Å–∫ –ø–æ —Ç–µ–≥–∞–º
```

#### 3. –ö–∞—Ä—Ç–æ—á–∫–∞ –ª–∏—Ä–∏–∫–∏
–ö–∞–∂–¥–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
- –ù–∞–∑–≤–∞–Ω–∏–µ
- –ü—Ä–µ–≤—å—é —Ç–µ–∫—Å—Ç–∞ (4 —Å—Ç—Ä–æ–∫–∏)
- –¢–µ–≥–∏
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π
- –î–∞—Ç—É —Å–æ–∑–¥–∞–Ω–∏—è

#### 4. –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä
–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞:
- –ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç
- –í—Å–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (–∂–∞–Ω—Ä, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ)
- –ü—Ä–æ–º–ø—Ç (–µ—Å–ª–∏ –µ—Å—Ç—å)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### 5. –î–µ–π—Å—Ç–≤–∏—è
- **–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å** üìã - —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç
- **–ò–∑–±—Ä–∞–Ω–Ω–æ–µ** ‚≠ê - –¥–æ–±–∞–≤–∏—Ç—å/—É–¥–∞–ª–∏—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
- **–£–¥–∞–ª–∏—Ç—å** üóëÔ∏è - —É–¥–∞–ª–∏—Ç—å –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

### –ö–∞–∫ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–∏—Ä–∏–∫—É

#### –ò–∑ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:
1. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –ª–∏—Ä–∏–∫—É –≤ —Ä–∞–∑–¥–µ–ª–µ "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è"
2. –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –Ω–∞–∂–º–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"
3. –í—ã–±–µ—Ä–∏—Ç–µ –ø–∞–ø–∫—É –∏ —Ç–µ–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

#### –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ:
```typescript
import { useSavedLyrics } from '@/hooks/useSavedLyrics';

const { saveLyrics } = useSavedLyrics();

await saveLyrics.mutateAsync({
  title: '–ù–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Å–Ω–∏',
  content: '–¢–µ–∫—Å—Ç –ø–µ—Å–Ω–∏...',
  tags: ['—Ä–æ–∫', '—ç–Ω–µ—Ä–≥–∏—á–Ω–∞—è'],
  folder: '–ê–ª—å–±–æ–º 2024',
  jobId: 'optional-job-id',
  variantId: 'optional-variant-id'
});
```

---

## üéß –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∞—É–¥–∏–æ

### –î–æ—Å—Ç—É–ø
–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Workspace ‚Üí –ê—É–¥–∏–æ** (`/workspace/audio-library`)

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### 1. –§–∏–ª—å—Ç—Ä—ã
- **–í—Å–µ** - –≤—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
- **–ò–∑–±—Ä–∞–Ω–Ω–æ–µ** ‚≠ê - –∏–∑–±—Ä–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- **–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ** üì§ - –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- **–ó–∞–ø–∏—Å–∏** üéôÔ∏è - –∞—É–¥–∏–æ –∑–∞–ø–∏—Å–∏
- **–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ** ‚ú® - AI-generated —Ç—Ä–µ–∫–∏
- **–ü–∞–ø–∫–∏** üìÅ - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞

#### 2. –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
1. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "Upload" ‚ûï
2. –í—ã–±–µ—Ä–∏—Ç–µ –∞—É–¥–∏–æ —Ñ–∞–π–ª
3. –î–æ–±–∞–≤—å—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ, —Ç–µ–≥–∏, –ø–∞–ø–∫—É (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
4. –ù–∞–∂–º–∏—Ç–µ "–ó–∞–≥—Ä—É–∑–∏—Ç—å"

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:**
- MP3, WAV, OGG, FLAC
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 50 MB

#### 3. –ö–∞—Ä—Ç–æ—á–∫–∞ –∞—É–¥–∏–æ
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
- –ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
- –¢–∏–ø –∏—Å—Ç–æ—á–Ω–∏–∫–∞
- –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞
- –¢–µ–≥–∏
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### 4. –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä
- **–ê—É–¥–∏–æ –ø–ª–µ–µ—Ä** üéµ - –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ
- **–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ** - –≤—Å–µ –¥–µ—Ç–∞–ª–∏ —Ñ–∞–π–ª–∞
- **–ê–Ω–∞–ª–∏–∑** - tempo, key, genre (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)
- **–û–ø–∏—Å–∞–Ω–∏–µ** –∏ —Ç–µ–≥–∏
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### 5. –î–µ–π—Å—Ç–≤–∏—è
- **–°–∫–∞—á–∞—Ç—å** üíæ - —Å–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª
- **–ò–∑–±—Ä–∞–Ω–Ω–æ–µ** ‚≠ê - –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
- **–£–¥–∞–ª–∏—Ç—å** üóëÔ∏è - —É–¥–∞–ª–∏—Ç—å

### –¢–∏–ø—ã –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

#### Upload (–ó–∞–≥—Ä—É–∂–µ–Ω–æ)
```typescript
// –ß–µ—Ä–µ–∑ UI –∏–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ:
const { saveAudio } = useAudioLibrary();

await saveAudio.mutateAsync({
  fileName: 'demo.mp3',
  fileUrl: 'https://...',
  fileSize: 5242880,
  durationSeconds: 180,
  sourceType: 'upload',
  tags: ['–≤–æ–∫–∞–ª', '–¥–µ–º–æ'],
  folder: 'Demos 2024'
});
```

#### Recording (–ó–∞–ø–∏—Å—å)
–î–ª—è –∞—É–¥–∏–æ, –∑–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

#### Generated (–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ)
–î–ª—è AI-generated —Ç—Ä–µ–∫–æ–≤ –∏–∑ —Å–∏—Å—Ç–µ–º—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

---

## üîç –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è

### –ü–æ–∏—Å–∫ –≤ –ª–∏—Ä–∏–∫–µ
```typescript
const { lyrics } = useSavedLyrics({
  search: '–ª—é–±–æ–≤—å', // Full-text search
  favorite: true,   // –¢–æ–ª—å–∫–æ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
  folder: '–ê–ª—å–±–æ–º 2024'
});
```

### –ü–æ–∏—Å–∫ –≤ –∞—É–¥–∏–æ
```typescript
const { items } = useAudioLibrary({
  sourceType: 'upload',
  favorite: true,
  folder: 'Demos 2024'
});
```

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç:
- **usage_count** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π
- **last_used_at** - –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```typescript
const { trackUsage } = useSavedLyrics();

// –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –ª–∏—Ä–∏–∫–∏:
await trackUsage.mutateAsync(lyricsId);
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### Row Level Security (RLS)
–í—Å–µ –¥–∞–Ω–Ω—ã–µ –∑–∞—â–∏—â–µ–Ω—ã RLS policies:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ
- CRUD —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
- Security Definer —Ç—Ä–∏–≥–≥–µ—Ä—ã

### –î–∞–Ω–Ω—ã–µ
- –õ–∏—Ä–∏–∫–∞ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ë–î
- –ê—É–¥–∏–æ —Ñ–∞–π–ª—ã –≤ Supabase Storage (bucket: reference-audio)
- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤ –ë–î –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞

---

## üí° Best Practices

### –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –ª–∏—Ä–∏–∫–∏
1. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–Ω—è—Ç–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è
2. ‚úÖ –î–æ–±–∞–≤–ª—è–π—Ç–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Ç–µ–≥–∏
3. ‚úÖ –ì—Ä—É–ø–ø–∏—Ä—É–π—Ç–µ –ø–æ –ø–∞–ø–∫–∞–º (–∞–ª—å–±–æ–º, –ø—Ä–æ–µ–∫—Ç)
4. ‚úÖ –î–æ–±–∞–≤–ª—è–π—Ç–µ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ –ª—É—á—à–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã

### –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∞—É–¥–∏–æ
1. ‚úÖ –£–∫–∞–∑—ã–≤–∞–π—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è uploaded —Ñ–∞–π–ª–æ–≤
2. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ–≥–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
3. ‚úÖ –ì—Ä—É–ø–ø–∏—Ä—É–π—Ç–µ –ø–æ —Ç–∏–ø—É (demo, reference, final)
4. ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤ (max 50MB)

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
1. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã –≤–º–µ—Å—Ç–æ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
2. ‚úÖ –ü–æ–∏—Å–∫ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞
3. ‚úÖ Lazy loading –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
4. ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ React Query

---

## üõ†Ô∏è API Reference

### useSavedLyrics Hook

```typescript
interface SaveLyricsParams {
  jobId?: string;
  variantId?: string;
  title: string;
  content?: string;
  tags?: string[];
  folder?: string;
}

const {
  lyrics,           // SavedLyrics[]
  isLoading,        // boolean
  error,            // Error | null
  saveLyrics,       // Mutation
  updateLyrics,     // Mutation
  deleteLyrics,     // Mutation
  toggleFavorite,   // Mutation
  trackUsage,       // Mutation
} = useSavedLyrics({
  search?: string;
  folder?: string;
  favorite?: boolean;
});
```

### useAudioLibrary Hook

```typescript
interface SaveAudioParams {
  fileName: string;
  fileUrl: string;
  fileSize?: number;
  durationSeconds?: number;
  sourceType: 'upload' | 'recording' | 'generated';
  sourceMetadata?: Record<string, any>;
  tags?: string[];
  folder?: string;
  description?: string;
}

const {
  items,            // AudioLibraryItem[]
  count,            // number
  isLoading,        // boolean
  error,            // Error | null
  saveAudio,        // Mutation
  updateAudio,      // Mutation
  deleteAudio,      // Mutation
  toggleFavorite,   // Mutation
  trackUsage,       // Mutation
} = useAudioLibrary({
  sourceType?: string;
  folder?: string;
  favorite?: boolean;
  limit?: number;
  offset?: number;
});
```

---

## üîß Troubleshooting

### –õ–∏—Ä–∏–∫–∞ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è (title, content)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –æ—à–∏–±–∫–∏

### –§–∞–π–ª –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç (MP3, WAV, OGG, FLAC)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–º–µ—Ä (max 50MB)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º

### –ü–æ–∏—Å–∫ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
1. –ü–æ–∏—Å–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã (folder, favorite)

---

## üìû Support

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Network tab
3. –°–≤—è–∂–∏—Ç–µ—Å—å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π

---

*–í–µ—Ä—Å–∏—è: 1.0.0*  
*–û–±–Ω–æ–≤–ª–µ–Ω–æ: 2025-01-24*
