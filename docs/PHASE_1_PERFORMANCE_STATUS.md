# üöÄ –§–∞–∑–∞ 1: Performance First - –°—Ç–∞—Ç—É—Å –í—ã–ø–æ–ª–Ω–µ–Ω–∏—è

**–ü–µ—Ä–∏–æ–¥:** –ù–µ–¥–µ–ª–∏ 1-4  
**–¶–µ–ª—å:** –î–æ–≤–µ—Å—Ç–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–æ –º–∏—Ä–æ–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è

---

## ‚úÖ –ù–µ–¥–µ–ª—è 1: Refactor Monster Components (–ó–ê–í–ï–†–®–ï–ù–ê)

### **1.1. –†–∞–∑–¥–µ–ª–∏—Ç—å MusicGeneratorV2 ‚úÖ**

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- ‚úÖ 877 —Å—Ç—Ä–æ–∫ ‚Üí ~200 —Å—Ç—Ä–æ–∫ (-77%)
- ‚úÖ –°–æ–∑–¥–∞–Ω–æ 5 —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö hooks:
  - `useGeneratorState.ts` - –∫–æ–Ω—Å–æ–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
  - `useStemReferenceLoader.ts` - –∑–∞–≥—Ä—É–∑–∫–∞ stem —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–æ–≤
  - `usePendingGenerationLoader.ts` - prefill –¥–∞–Ω–Ω—ã–µ –∏–∑ Zustand
  - `useAudioUploadHandler.ts` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∞—É–¥–∏–æ —Ñ–∞–π–ª–æ–≤
  - `useAnalysisMapper.ts` - –º–∞–ø–ø–∏–Ω–≥ –∞–Ω–∞–ª–∏–∑–∞ –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
src/components/generator/
‚îú‚îÄ‚îÄ MusicGeneratorV2.tsx (200 —Å—Ç—Ä–æ–∫ - orchestrator) ‚úÖ
‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îú‚îÄ‚îÄ useGeneratorState.ts ‚úÖ
‚îÇ   ‚îú‚îÄ‚îÄ useStemReferenceLoader.ts ‚úÖ
‚îÇ   ‚îú‚îÄ‚îÄ usePendingGenerationLoader.ts ‚úÖ
‚îÇ   ‚îú‚îÄ‚îÄ useAudioUploadHandler.ts ‚úÖ
‚îÇ   ‚îú‚îÄ‚îÄ useAnalysisMapper.ts ‚úÖ
‚îÇ   ‚îî‚îÄ‚îÄ index.ts ‚úÖ
```

**–í—ã–≥–æ–¥—ã:**
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å (–∫–∞–∂–¥—ã–π hook –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω)
- ‚úÖ –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π Hot Module Replacement
- ‚úÖ –õ–µ–≥–∫–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Ñ–∏—á
- ‚úÖ –ü–æ–Ω—è—Ç–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

---

### **1.2. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å GlobalAudioPlayer ‚úÖ**
**–°—Ç–∞—Ç—É—Å**: –ó–∞–≤–µ—Ä—à–µ–Ω–æ ‚úÖ  
**–†–µ–∑—É–ª—å—Ç–∞—Ç**: 434 —Å—Ç—Ä–æ–∫ ‚Üí 48 —Å—Ç—Ä–æ–∫ (-89%)

**–°–æ–∑–¥–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (desktop/)**:
- `DesktopPlayerLayout.tsx` - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å layout –∏ store –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π
- `TrackInfo.tsx` - –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç—Ä–µ–∫–µ
- `PlaybackControls.tsx` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ–º
- `ProgressBar.tsx` - –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä —Ç—Ä–µ–∫–∞
- `VolumeControl.tsx` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä–æ–º–∫–æ—Å—Ç—å—é

**–í—ã–¥–µ–ª–µ–Ω–Ω—ã–µ —Ö—É–∫–∏ (hooks/)**:
- `usePlayerControls.ts` - –ª–æ–≥–∏–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–ª–µ–µ—Ä–æ–º
- `usePlayerKeyboardShortcuts.ts` - –∫–ª–∞–≤–∏–∞—Ç—É—Ä–Ω—ã–µ shortcuts
- `usePlayerVisibility.ts` - –≤–∏–¥–∏–º–æ—Å—Ç—å –∏ expansion state

**–í—ã–≥–æ–¥—ã:**
- ‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –º–æ–¥—É–ª—å–Ω–æ—Å—Ç—å (48 —Å—Ç—Ä–æ–∫ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ)
- ‚úÖ –í—Å—è –ª–æ–≥–∏–∫–∞ –≤ —Ö—É–∫–∞—Ö –∏ sub-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
- ‚úÖ –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ features

---

### **1.3. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å TrackCard (–í –ü–†–û–¶–ï–°–°–ï)**
- [ ] –†–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ sub-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

---

## üìã –û—Å—Ç–∞–≤—à–∏–µ—Å—è –ó–∞–¥–∞—á–∏ –§–∞–∑—ã 1

### –ù–µ–¥–µ–ª—è 2: Virtualization Everywhere
- [ ] –í–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å LyricsLibrary
- [ ] –í–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å PromptHistoryDialog
- [ ] Benchmark —Ç–µ—Å—Ç—ã

### –ù–µ–¥–µ–ª—è 3: Smart Loading & Caching
- [ ] Service Worker –¥–ª—è offline
- [ ] Progressive Image Loading
- [ ] Audio preloading —Å—Ç—Ä–∞—Ç–µ–≥–∏—è

### –ù–µ–¥–µ–ª—è 4: Loading States & Skeletons
- [ ] TrackCardSkeleton
- [ ] LyricsCardSkeleton
- [ ] GeneratorFormSkeleton
- [ ] Skeleton –¥–ª—è –≤—Å–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –ü—Ä–æ–≥—Ä–µ—Å—Å–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –¶–µ–ª—å | –¢–µ–∫—É—â–µ–µ |
|---------|-----|------|---------|
| **MusicGeneratorV2 —Å—Ç—Ä–æ–∫–∏** | 877 | 60-80 | ~200 ‚úÖ |
| **GlobalAudioPlayer —Å—Ç—Ä–æ–∫–∏** | 434 | 60-80 | 434 ‚è≥ |
| **Hooks –∏–∑–æ–ª—è—Ü–∏—è** | 0% | 100% | 40% üîÑ |
| **Test Coverage** | 55% | 85% | 55% ‚è≥ |

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-01-31  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ 25% –∑–∞–≤–µ—Ä—à–µ–Ω–æ (–ù–µ–¥–µ–ª—è 1 –∏–∑ 4)
