# Стратегия тестирования Albert3 Muse Synth Studio

## 1. Пирамида тестирования

| Тип теста | Инструменты | Покрытие | Цель |
| :--- | :--- | :--- | :--- |
| **Unit** | Vitest, React Testing Library | >80% | Тестирование отдельных компонентов, хуков и утилит в изоляции. |
| **Integration** | Vitest, MSW | Критические пути | Тестирование взаимодействия нескольких компонентов, проверка FE↔Edge контрактов. |
| **E2E** | Playwright | Ключевые сценарии | Тестирование полных пользовательских сценариев в окружении, близком к production. |
| **Visual Regression** | Playwright / Applitools | Основные страницы | Автоматическое выявление непреднамеренных UI-изменений. |
| **Accessibility** | Axe-core | Все страницы | Автоматическое тестирование на соответствие WCAG 2.2 AA. |

## 2. Области покрытия

*   **Критическое:**
    *   Аутентификация (вход, выход, регистрация).
    *   Процесс генерации музыки (Suno & Mureka).
    *   Управление кредитами и балансом.
    *   Основные функции плеера.
*   **Важное:**
    *   Разделение на стемы.
    *   Создание проектов и управление треками.
    *   Настройки профиля.

## 3. Тестирование контрактов (FE ↔ Edge)

*   **Инструмент:** `msw` (Mock Service Worker) будет использоваться для мокирования ответов Supabase Edge Functions.
*   **Процесс:**
    1.  Создать моки, соответствующие реальным контрактам API (типы запросов и ответов).
    2.  Интеграционные тесты будут использовать эти моки для проверки корректности обработки данных на фронтенде.

## 4. E2E-сценарии

1.  **Сценарий "Счастливый путь" генерации:**
    *   Пользователь логинится.
    *   Переходит на страницу генерации.
    *   Вводит промпт, выбирает модель Suno.
    *   Нажимает "Сгенерировать".
    *   Видит уведомление о начале генерации.
    *   Через некоторое время трек появляется в списке со статусом "Completed".
2.  **Сценарий обработки ошибок:**
    *   Пользователь пытается сгенерировать трек с недостаточным балансом.
    *   Получает понятное сообщение об ошибке.
3.  **Сценарий доступности:**
    *   Запустить Axe-сканирование на главной странице, странице генерации и в профиле.
    *   Тест должен завершиться без критических нарушений.

## 5. Визуальное и Accessibility тестирование

*   **Визуальное:** Снимки экрана для ключевых страниц (`/`, `/workspace`, `/profile`) будут создаваться и сравниваться на каждом PR.
*   **Accessibility:** Axe будет запускаться в рамках E2E-тестов для каждой страницы, которую посещает тест.
