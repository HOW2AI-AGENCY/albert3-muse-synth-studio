# –ê—É–¥–∏—Ç —Å–∏—Å—Ç–µ–º—ã –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è —Ç—Ä–µ–∫–æ–≤

**–î–∞—Ç–∞**: 2025-10-15  
**–í–µ—Ä—Å–∏—è**: 2.4.0  
**–°—Ç–∞—Ç—É—Å**: üî¥ –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥

## üéØ –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –ö–æ–Ω—Ñ–ª–∏–∫—Ç –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∏ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤–µ—Ä—Å–∏–π

#### –¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
```
TrackCard (–ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)
  ‚îú‚îÄ activeVersionIndex: number
  ‚îú‚îÄ handleVersionChange(index)
  ‚îî‚îÄ activeVersion = allVersions[activeVersionIndex]

AudioPlayerProvider (–≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)
  ‚îú‚îÄ versions.currentVersionIndex
  ‚îú‚îÄ switchToVersion(versionId)
  ‚îî‚îÄ –û—á–µ—Ä–µ–¥—å –≤–µ—Ä—Å–∏–π –¥–ª—è –∞–≤—Ç–æ–ø–µ—Ä–µ—Ö–æ–¥–∞
```

#### –ü—Ä–æ–±–ª–µ–º–∞
- **TrackCard** —É–ø—Ä–∞–≤–ª—è–µ—Ç –í–ò–ó–£–ê–õ–¨–ù–´–ú –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –≤–µ—Ä—Å–∏–∏ (1/2, –æ–±–ª–æ–∂–∫–∞, –Ω–∞–∑–≤–∞–Ω–∏–µ)
- **AudioPlayerProvider** —É–ø—Ä–∞–≤–ª—è–µ—Ç –†–ï–ê–õ–¨–ù–´–ú –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ–º
- –≠—Ç–∏ –¥–≤–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ù–ï —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã!

#### –ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç —Å—Ç—Ä–µ–ª–∫—É ‚Üí –º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–∞—Ä—Ç–∏–Ω–∫–∞ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ
2. –ü–ª–µ–µ—Ä –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –∏–≥—Ä–∞—Ç—å –î–†–£–ì–£–Æ –≤–µ—Ä—Å–∏—é
3. –ü—Ä–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–∏ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è –≤—ã–±—Ä–∞–Ω–Ω–∞—è –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ –≤–µ—Ä—Å–∏—è
4. DetailPanel –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–µ—Ç–∞–ª–∏ –Ω–µ —Ç–æ–π –≤–µ—Ä—Å–∏–∏, —á—Ç–æ –∏–≥—Ä–∞–µ—Ç

---

### 2. –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –≤—ã–±–æ—Ä–∞ –≤–µ—Ä—Å–∏–π

#### useSmartTrackPlay
```typescript
// –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:
// 1. –ú–∞—Å—Ç–µ—Ä-–≤–µ—Ä—Å–∏—è (is_preferred_variant)
// 2. –û—Ä–∏–≥–∏–Ω–∞–ª (variant_index === 0)
// 3. –ü–µ—Ä–≤–∞—è –¥–æ—Å—Ç—É–ø–Ω–∞—è

const selectBestVersion = (versions) => {
  const master = versions.find(v => v.isMasterVersion);
  if (master) return master;
  
  const original = versions.find(v => v.versionNumber === 0);
  if (original) return original;
  
  return versions[0];
}
```

#### TrackCard
```typescript
// –ü—Ä–æ—Å—Ç–æ –±–µ—Ä–µ—Ç –ø–æ –∏–Ω–¥–µ–∫—Å—É
const activeVersion = allVersions[activeVersionIndex];
```

#### –ü—Ä–æ–±–ª–µ–º–∞
- –†–∞–∑–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ "–¥–µ—Ñ–æ–ª—Ç–Ω–æ–π" –≤–µ—Ä—Å–∏–∏
- –ü—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ TrackCard –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–µ—Ä—Å–∏—é 0 (–æ—Ä–∏–≥–∏–Ω–∞–ª)
- –ü—Ä–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–∏ –º–æ–∂–µ—Ç –≤–∫–ª—é—á–∏—Ç—å—Å—è –º–∞—Å—Ç–µ—Ä-–≤–µ—Ä—Å–∏—è
- –ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å UX

---

### 3. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≤–µ—Ä—Å–∏–π

#### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª Play
```
1. TrackCard.handlePlayClick()
2. playTrack(audioTrack) ‚Üí AudioPlayerProvider
3. versions.loadVersions(trackId) ‚Üê –ó–ê–ì–†–£–ó–ö–ê 1
4. queue.setQueue(allVersionsQueue)
5. playback.playTrack(track)
```

#### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –í–µ—Ä—Å–∏–∏ —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ useTrackVersions
```
1. TrackCard –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è
2. useTrackVersions(trackId, autoLoad=true) ‚Üê –ó–ê–ì–†–£–ó–ö–ê 2
3. versions –∑–∞–≥—Ä—É–∂–µ–Ω—ã, mainVersion –ø–æ–ª—É—á–µ–Ω
```

#### –ü—Ä–æ–±–ª–µ–º–∞
- **–î–≤–æ–π–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞** –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ –¥–∞–Ω–Ω—ã—Ö
- –í–µ—Ä—Å–∏–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ TrackCard —á–µ—Ä–µ–∑ `useTrackVersions`
- –ò —Å–Ω–æ–≤–∞ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ –ø–ª–µ–µ—Ä–µ —á–µ—Ä–µ–∑ `AudioPlayerProvider.playTrack`
- –ö—ç—à –ø–æ–º–æ–≥–∞–µ—Ç, –Ω–æ –ª–æ–≥–∏–∫–∞ –∑–∞–ø—É—Ç–∞–Ω–Ω–∞—è

---

### 4. –ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –ø–æ—Ä—è–¥–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è

#### –¢–µ–∫—É—â–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥–∏
```typescript
// AudioPlayerProvider.playTrack
const allVersionsQueue = versionsList.map(v => ({...}));
queue.setQueue(allVersionsQueue);
```

**–ü—Ä–æ–±–ª–µ–º–∞**: –ö–∞–∂–¥—ã–π —Ä–∞–∑ –ø—Ä–∏ `playTrack` –æ—á–µ—Ä–µ–¥—å –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤–µ—Ä—Å–∏—è–º–∏ —Ç—Ä–µ–∫–∞!

#### –ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–∏–ª 5 —Ç—Ä–µ–∫–æ–≤ –≤ –æ—á–µ—Ä–µ–¥—å
2. –ù–∞–∂–∞–ª Play –Ω–∞ –æ–¥–Ω–æ–º —Ç—Ä–µ–∫–µ ‚Üí –æ—á–µ—Ä–µ–¥—å –∑–∞–º–µ–Ω–∏–ª–∞—Å—å –Ω–∞ –≤–µ—Ä—Å–∏–∏ —ç—Ç–æ–≥–æ —Ç—Ä–µ–∫–∞
3. –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–∫–∏ –∏–∑ –æ—á–µ—Ä–µ–¥–∏ –∏—Å—á–µ–∑–ª–∏ ‚ùå

---

## üîß –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º—ã–µ —Ä–µ—à–µ–Ω–∏—è

### –†–µ—à–µ–Ω–∏–µ 1: –ï–¥–∏–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤–µ—Ä—Å–∏–π

#### –ü–æ–¥—Ö–æ–¥ A: –ö–∞—Ä—Ç–æ—á–∫–∞ —Å–ª–µ–¥—É–µ—Ç –∑–∞ –ø–ª–µ–µ—Ä–æ–º
```typescript
// TrackCard.tsx
const { currentTrack } = useAudioPlayer();

// –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –≤–µ—Ä—Å–∏—é –∏–∑ –ø–ª–µ–µ—Ä–∞
const activeVersionIndex = useMemo(() => {
  if (currentTrack?.parentTrackId === track.id) {
    return currentTrack.versionNumber ?? 0;
  }
  return 0; // –î–µ—Ñ–æ–ª—Ç - –æ—Ä–∏–≥–∏–Ω–∞–ª
}, [currentTrack, track.id]);

// –ù–ï —Ö—Ä–∞–Ω–∏–º –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ!
```

**–ü–ª—é—Å—ã**:
- –ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã
- –ö–∞—Ä—Ç–æ—á–∫–∞ –≤—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ, —á—Ç–æ –∏–≥—Ä–∞–µ—Ç

**–ú–∏–Ω—É—Å—ã**:
- –ù–µ–ª—å–∑—è "–ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å" –≤–µ—Ä—Å–∏—é –¥–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
- –°–º–µ–Ω–∞ –≤–µ—Ä—Å–∏–∏ —Å—Ä–∞–∑—É –Ω–∞—á–∏–Ω–∞–µ—Ç –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ

#### –ü–æ–¥—Ö–æ–¥ B: –ü–ª–µ–µ—Ä —Å–ª–µ–¥—É–µ—Ç –∑–∞ –∫–∞—Ä—Ç–æ—á–∫–æ–π ‚≠ê –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø
```typescript
// TrackCard.tsx
const [selectedVersionIndex, setSelectedVersionIndex] = useState(0);

const handlePlayClick = () => {
  const version = allVersions[selectedVersionIndex];
  playTrack(version); // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –í–´–ë–†–ê–ù–ù–£–Æ –≤–µ—Ä—Å–∏—é
};

const handleVersionChange = (newIndex) => {
  setSelectedVersionIndex(newIndex);
  // –ù–ï –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º —Å—Ä–∞–∑—É, —Ç–æ–ª—å–∫–æ –º–µ–Ω—è–µ–º –≤–∏–∑—É–∞–ª
};
```

**–ü–ª—é—Å—ã**:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç "–≤—ã–±—Ä–∞—Ç—å" –≤–µ—Ä—Å–∏—é –¥–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
- –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç–Ω–æ: —á—Ç–æ –≤—ã–±—Ä–∞–Ω–æ ‚Üí —Ç–æ –∏ –∏–≥—Ä–∞–µ—Ç

**–ú–∏–Ω—É—Å—ã**:
- –ù—É–∂–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ç—Ä–µ–∫–∞ –≤ –ø–ª–µ–µ—Ä–µ

---

### –†–µ—à–µ–Ω–∏–µ 2: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã –æ—á–µ—Ä–µ–¥–µ–π

#### –¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞
```typescript
playTrack(track) ‚Üí queue.setQueue(versions) // ‚ùå –ü–µ—Ä–µ–∑–∞–ø–∏—Å—å –æ—á–µ—Ä–µ–¥–∏!
```

#### –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ
```typescript
// –†–∞–∑–¥–µ–ª—å–Ω—ã–µ –æ—á–µ—Ä–µ–¥–∏
interface AudioPlayerQueue {
  mainQueue: AudioPlayerTrack[];      // –û—á–µ—Ä–µ–¥—å —Ç—Ä–µ–∫–æ–≤
  versionsQueue: AudioPlayerTrack[];  // –í–µ—Ä—Å–∏–∏ —Ç–µ–∫—É—â–µ–≥–æ —Ç—Ä–µ–∫–∞
  mode: 'tracks' | 'versions';        // –†–µ–∂–∏–º –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
}

// –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
playNext() {
  if (mode === 'versions') {
    // –°–ª–µ–¥—É—é—â–∞—è –≤–µ—Ä—Å–∏—è —Ç–µ–∫—É—â–µ–≥–æ —Ç—Ä–µ–∫–∞
    const nextVersion = versionsQueue[currentVersionIndex + 1];
    if (nextVersion) play(nextVersion);
    else mode = 'tracks'; // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ç—Ä–µ–∫—É
  } else {
    // –°–ª–µ–¥—É—é—â–∏–π —Ç—Ä–µ–∫ –∏–∑ –æ—á–µ—Ä–µ–¥–∏
    const nextTrack = mainQueue[currentTrackIndex + 1];
    play(nextTrack);
  }
}
```

**–ü–æ–≤–µ–¥–µ–Ω–∏–µ**:
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–∏–ª —Ç—Ä–µ–∫–∏ A, B, C –≤ –æ—á–µ—Ä–µ–¥—å
2. –ò–≥—Ä–∞–µ—Ç —Ç—Ä–µ–∫ A (–≤–µ—Ä—Å–∏—è 1) ‚Üí versionsQueue = [A-v1, A-v2]
3. –ù–∞–∂–∞–ª Next ‚Üí –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ A-v2
4. –ù–∞–∂–∞–ª Next –µ—â–µ —Ä–∞–∑ ‚Üí –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ —Ç—Ä–µ–∫ B

---

### –†–µ—à–µ–Ω–∏–µ 3: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤–µ—Ä—Å–∏–π

#### –ü—Ä–æ–±–ª–µ–º–∞: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∑–∫–∏
```typescript
// TrackCard
useTrackVersions(trackId, autoLoad=true); // –ó–ê–ì–†–£–ó–ö–ê 1

// AudioPlayerProvider
versions.loadVersions(trackId);           // –ó–ê–ì–†–£–ó–ö–ê 2
```

#### –†–µ—à–µ–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—â–∏–π –∫—ç—à
```typescript
// useTrackVersions —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫—ç—à —Å Map
const versionsCache = new Map<string, TrackWithVersions[]>();

// AudioPlayerProvider –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∫—ç—à
const playTrack = async (track) => {
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—ç—à –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π
  const cached = getVersionsFromCache(baseTrackId);
  const versionsList = cached || await loadVersions(baseTrackId);
  // ...
};
```

---

## üìù –ü–ª–∞–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

### Phase 1: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ TrackCard ‚ö° –°–†–û–ß–ù–û
- [ ] –£–±—Ä–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `activeVersionIndex`
- [ ] –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å `currentTrack.versionNumber` –∏–∑ –ø–ª–µ–µ—Ä–∞
- [ ] –£–±—Ä–∞—Ç—å –ª–æ–≥–∏–∫—É –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∏–∑ `handlePlayClick`
- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `playTrack(selectedVersion)` –Ω–∞–ø—Ä—è–º—É—é

### Phase 2: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –æ—á–µ—Ä–µ–¥–µ–π
- [ ] –°–æ–∑–¥–∞—Ç—å `QueueManager` —Å —Ä–∞–∑–¥–µ–ª—å–Ω—ã–º–∏ –æ—á–µ—Ä–µ–¥—è–º–∏
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–µ–∂–∏–º—ã 'tracks' | 'versions'
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `playNext/playPrevious` –ª–æ–≥–∏–∫—É

### Phase 3: –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤–µ—Ä—Å–∏–π
- [ ] –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫—ç—à –≤–µ—Ä—Å–∏–π
- [ ] –£–±—Ä–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–æ–∫
- [ ] –î–æ–±–∞–≤–∏—Ç—å preloading –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è

### Phase 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] Unit —Ç–µ—Å—Ç—ã –¥–ª—è QueueManager
- [ ] Integration —Ç–µ—Å—Ç—ã –¥–ª—è playback flow
- [ ] E2E —Ç–µ—Å—Ç—ã –¥–ª—è UX —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

---

## üé¨ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π
```
–î–∞–Ω–æ: –¢—Ä–µ–∫ —Å 2 –≤–µ—Ä—Å–∏—è–º–∏ (v0, v1)
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç "1/2" –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ
2. –ù–∞–∂–∏–º–∞–µ—Ç —Å—Ç—Ä–µ–ª–∫—É ‚Üí "2/2"
3. –ù–∞–∂–∏–º–∞–µ—Ç Play
–û–∂–∏–¥–∞–Ω–∏–µ: –î–æ–ª–∂–Ω–∞ –∏–≥—Ä–∞—Ç—å v1 (–≤—Ç–æ—Ä–∞—è –≤–µ—Ä—Å–∏—è)
–¢–µ–∫—É—â–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ: ‚ùå –ò–≥—Ä–∞–µ—Ç v0 (–ø–µ—Ä–≤–∞—è –≤–µ—Ä—Å–∏—è)
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –û—á–µ—Ä–µ–¥—å —Ç—Ä–µ–∫–æ–≤
```
–î–∞–Ω–æ: 3 —Ç—Ä–µ–∫–∞ –≤ –æ—á–µ—Ä–µ–¥–∏ (A, B, C)
1. –ò–≥—Ä–∞–µ—Ç —Ç—Ä–µ–∫ A
2. –ù–∞–∂–∏–º–∞–µ—Ç Next
–û–∂–∏–¥–∞–Ω–∏–µ: –î–æ–ª–∂–µ–Ω –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ —Ç—Ä–µ–∫ B
–¢–µ–∫—É—â–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ: ‚ùå –ú–æ–∂–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ A-v2
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –î–µ—Ç–∞–ª–∏ —Ç—Ä–µ–∫–∞
```
–î–∞–Ω–æ: –¢—Ä–µ–∫ —Å –≤–µ—Ä—Å–∏—è–º–∏, –æ—Ç–∫—Ä—ã—Ç–∞ DetailPanel
1. –ù–∞ –∫–∞—Ä—Ç–æ—á–∫–µ –≤—ã–±—Ä–∞–Ω–∞ v1
2. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç DetailPanel
–û–∂–∏–¥–∞–Ω–∏–µ: –î–æ–ª–∂–Ω—ã –ø–æ–∫–∞–∑–∞—Ç—å—Å—è –¥–µ—Ç–∞–ª–∏ v1
–¢–µ–∫—É—â–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ: ‚ùå –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –¥–µ—Ç–∞–ª–∏ v0
```

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –¢—Ä–µ–±—É—é—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π
- `src/features/tracks/components/TrackCard.tsx`
- `src/contexts/audio-player/AudioPlayerProvider.tsx`
- `src/contexts/audio-player/useAudioQueue.ts`
- `src/contexts/audio-player/useAudioVersions.ts`

### –ú–æ–≥—É—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- `src/components/workspace/DetailPanelContent.tsx`
- `src/features/tracks/ui/DetailPanel.tsx`
- `src/hooks/useSmartTrackPlay.ts`

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–°—Ä–æ—á–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å**: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –≤–µ—Ä—Å–∏–π –º–µ–∂–¥—É TrackCard –∏ –ø–ª–µ–µ—Ä–æ–º
2. **–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã –æ—á–µ—Ä–µ–¥–µ–π
3. **–ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ (—É–∂–µ –µ—Å—Ç—å –∫—ç—à)

---

**–°—Ç–∞—Ç—É—Å**: –î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω, —Ç—Ä–µ–±—É–µ—Ç—Å—è —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Ä–µ—à–µ–Ω–∏–π
